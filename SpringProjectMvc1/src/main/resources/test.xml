<select id="getAmiTotalMonth" parameterType="java.util.HashMap"
		resultType="AmiStatisticsModels">
		
		SELECT
		ANY_VALUE(REG_TIME) AS REG_DATE,
		SUM(CASE WHEN AMI_ID = 1 THEN OUT_ENERGY END)AS	GENERATOR_ENERGY_1,
		SUM(CASE WHEN AMI_ID = 2 THEN OUT_ENERGY END)AS GENERATOR_ENERGY_2,
		SUM(CASE WHEN AMI_ID = 3 THEN OUT_ENERGY END)AS GENERATOR_ENERGY_3,
		SUM(CASE WHEN AMI_ID = 4 THEN IN_ENERGY END)AS EQUIPMENT_1,
		SUM(CASE WHEN AMI_ID = 5 THEN IN_ENERGY END)AS EQUIPMENT_2,
		SUM(CASE WHEN AMI_ID = 6 THEN IN_ENERGY END)AS EQUIPMENT_3,
		SUM(CASE WHEN AMI_ID = 7 THEN IN_ENERGY END)AS IN_BATTERY,
		SUM(CASE WHEN AMI_ID = 7 THEN OUT_ENERGY END)AS OUT_BATTERY

		FROM PMS_AMI_MONTH_STATISTICS
		
		WHERE 1 = 1
		<if test="DATASTART != '' ">
		<![CDATA[AND REG_DATE = SUBSTRING(#{DATASTART}, 1, 4)]]>
		</if>
	
	</select>